window.onload=()=>{var e=document.getElementById("save-prompt-btn"),t=document.getElementById("save-options-btn");const o=document.getElementById("tts-enabled"),d=document.getElementById("tts-model");function n(){o.checked?(document.getElementById("tts-model").disabled=!1,document.getElementById("tts-voice").disabled=!1):(document.getElementById("tts-model").disabled=!0,document.getElementById("tts-voice").disabled=!0),"tts-chrome"==d.value&&(document.getElementById("tts-voice").disabled=!0)}function l(){const t=document.getElementById("prompt");chrome.storage.sync.get({Persona:"teacher",BotAction:"explain the concept of the text",ReadingLevel:"beginner",WordLimit:"30"},function(e){t.textContent=` You are a/an ${e.Persona} and 
          ${e.BotAction} the user provides at a/an 
          ${e.ReadingLevel} level of the topic. 
          Limit responses to ${e.WordLimit} words.`})}function a(){chrome.storage.local.get(["OpenAIKey"]).then(e=>{e.OpenAIKey&&(document.getElementById("api-key").value=e.OpenAIKey)}),chrome.storage.sync.get({ReadingLevel:"unset",Persona:"unset",BotAction:"unset",WordLimit:"unset",TTS:"unset",GPT:"unset",Voice:"unset",TTSEnabled:"unset"},i)}function i(e){"unset"!=e.ReadingLevel&&(document.getElementById("reading-level").value=e.ReadingLevel),"unset"!=e.Persona&&(document.getElementById("persona").value=e.Persona),"unset"!=e.BotAction&&(document.getElementById("action").value=e.BotAction),"unset"!=e.WordLimit&&(document.getElementById("word-limit").value=e.WordLimit),"unset"!=e.TTS&&(document.getElementById("tts-model").value=e.TTS),"unset"!=e.GPT&&(document.getElementById("gpt-model").value=e.GPT),"unset"!=e.Voice&&(document.getElementById("tts-voice").value=e.Voice),"unset"!=e.TTSEnabled&&(o.checked=e.TTSEnabled,n())}e.addEventListener("click",function(){var e=document.getElementById("reading-level"),t=document.getElementById("persona"),n=document.getElementById("action"),o=document.getElementById("word-limit");Number.isNaN(o.value)?console.log("Word limit is not a number, please use a real number"):chrome.storage.sync.set({ReadingLevel:e.value.toString().toLowerCase(),BotAction:n.value.toString().toLowerCase(),Persona:t.value.toString().toLowerCase(),WordLimit:o.value},function(){l()})}),t.addEventListener("click",function(){var e=document.getElementById("api-key"),t=document.getElementById("tts-voice"),n=document.getElementById("gpt-model");chrome.storage.local.set({OpenAIKey:e.value.toString()}),chrome.storage.sync.set({TTS:d.value.toString().toLowerCase(),GPT:n.value.toString().toLowerCase(),Voice:t.value.toString().toLowerCase(),TTSEnabled:o.checked},function(){a()})}),o.addEventListener("click",n),d.addEventListener("input",n),document.getElementById("uninstall-btn").addEventListener("click",function(){chrome.management.uninstallSelf({showConfirmDialog:!0}).catch(e=>{console.error("Uninstall failed -",e)})}),a(),l()};